<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-On Programming with R - Appendix D — Loading and Saving Data in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<link href="./a5-debug.html" rel="next">
<link href="./a3-updating.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Appendix D — Loading and Saving Data in R</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hands-On Programming with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jjallaire/hopr/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./dice.html" class="sidebar-item-text sidebar-link">Project 1: Weighted Dice</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Very Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Packages and Help Pages</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./cards.html" class="sidebar-item-text sidebar-link">Project 2: Playing Cards</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objects.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Objects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R Notation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modifying.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modifying Values</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./environments.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Environments</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./slots.html" class="sidebar-item-text sidebar-link">Project 3: Slot Machine</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Programs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">S3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Loops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./speed.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Speed</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a1-starting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing R and RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a2-packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">R Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a3-updating.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Updating R and Its Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a4-data.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Loading and Saving Data in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a5-debug.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Debugging R Code</span></a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-sets-in-base-r" id="toc-data-sets-in-base-r" class="nav-link active" data-scroll-target="#data-sets-in-base-r"> <span class="header-section-number">D.1</span> Data Sets in Base R</a></li>
  <li><a href="#working-directory" id="toc-working-directory" class="nav-link" data-scroll-target="#working-directory"> <span class="header-section-number">D.2</span> Working Directory</a></li>
  <li><a href="#plain-text-files" id="toc-plain-text-files" class="nav-link" data-scroll-target="#plain-text-files"> <span class="header-section-number">D.3</span> Plain-text Files</a>
  <ul class="collapse">
  <li><a href="#read.table" id="toc-read.table" class="nav-link" data-scroll-target="#read.table"> <span class="header-section-number">D.3.1</span> read.table</a></li>
  <li><a href="#the-read-family" id="toc-the-read-family" class="nav-link" data-scroll-target="#the-read-family"> <span class="header-section-number">D.3.2</span> The read Family</a></li>
  <li><a href="#read.fwf" id="toc-read.fwf" class="nav-link" data-scroll-target="#read.fwf"> <span class="header-section-number">D.3.3</span> read.fwf</a></li>
  <li><a href="#html-links" id="toc-html-links" class="nav-link" data-scroll-target="#html-links"> <span class="header-section-number">D.3.4</span> HTML Links</a></li>
  <li><a href="#saving-plain-text-files" id="toc-saving-plain-text-files" class="nav-link" data-scroll-target="#saving-plain-text-files"> <span class="header-section-number">D.3.5</span> Saving Plain-Text Files</a></li>
  <li><a href="#compressing-files" id="toc-compressing-files" class="nav-link" data-scroll-target="#compressing-files"> <span class="header-section-number">D.3.6</span> Compressing Files</a></li>
  </ul></li>
  <li><a href="#r-files" id="toc-r-files" class="nav-link" data-scroll-target="#r-files"> <span class="header-section-number">D.4</span> R Files</a>
  <ul class="collapse">
  <li><a href="#saving-r-files" id="toc-saving-r-files" class="nav-link" data-scroll-target="#saving-r-files"> <span class="header-section-number">D.4.1</span> Saving R Files</a></li>
  </ul></li>
  <li><a href="#excel-spreadsheets" id="toc-excel-spreadsheets" class="nav-link" data-scroll-target="#excel-spreadsheets"> <span class="header-section-number">D.5</span> Excel Spreadsheets</a>
  <ul class="collapse">
  <li><a href="#export-from-excel" id="toc-export-from-excel" class="nav-link" data-scroll-target="#export-from-excel"> <span class="header-section-number">D.5.1</span> Export from Excel</a></li>
  <li><a href="#copy-and-paste" id="toc-copy-and-paste" class="nav-link" data-scroll-target="#copy-and-paste"> <span class="header-section-number">D.5.2</span> Copy and Paste</a></li>
  <li><a href="#xlconnect" id="toc-xlconnect" class="nav-link" data-scroll-target="#xlconnect"> <span class="header-section-number">D.5.3</span> XLConnect</a></li>
  <li><a href="#reading-spreadsheets" id="toc-reading-spreadsheets" class="nav-link" data-scroll-target="#reading-spreadsheets"> <span class="header-section-number">D.5.4</span> Reading Spreadsheets</a></li>
  <li><a href="#writing-spreadsheets" id="toc-writing-spreadsheets" class="nav-link" data-scroll-target="#writing-spreadsheets"> <span class="header-section-number">D.5.5</span> Writing Spreadsheets</a></li>
  </ul></li>
  <li><a href="#loading-files-from-other-programs" id="toc-loading-files-from-other-programs" class="nav-link" data-scroll-target="#loading-files-from-other-programs"> <span class="header-section-number">D.6</span> Loading Files from Other Programs</a>
  <ul class="collapse">
  <li><a href="#connecting-to-databases" id="toc-connecting-to-databases" class="nav-link" data-scroll-target="#connecting-to-databases"> <span class="header-section-number">D.6.1</span> Connecting to Databases</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jjallaire/hopr/edit/master/a4-data.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-appendix-dataio" class="quarto-section-identifier d-none d-lg-block">Appendix D — Loading and Saving Data in R</span></h1>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>This appendix will show you how to load and save data into R from plain-text files, R files, and Excel spreadsheets. It will also show you the R packages that you can use to load data from databases and other common programs, like SAS and MATLAB.</p>
<section id="data-sets-in-base-r" class="level2" data-number="D.1">
<h2 data-number="D.1" class="anchored" data-anchor-id="data-sets-in-base-r"><span class="header-section-number">D.1</span> Data Sets in Base R</h2>
<p>R comes with many data sets preloaded in the <code>datasets</code> package, which comes with base R. These data sets are not very interesting, but they give you a chance to test code or make a point without having to load a data set from outside R. You can see a list of R’s data sets as well as a short description of each by running:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="at">package =</span> <span class="st">"datasets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To use a data set, just type its name. Each data set is already presaved as an R object. For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>iris</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6          5.4         3.9          1.7         0.4  setosa</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, R’s data sets are no substitute for your own data, which you can load into R from a wide variety of file formats. But before you load any data files into R, you’ll need to determine where your <em>working directory</em> is.</p>
</section>
<section id="working-directory" class="level2" data-number="D.2">
<h2 data-number="D.2" class="anchored" data-anchor-id="working-directory"><span class="header-section-number">D.2</span> Working Directory</h2>
<p>Each time you open R, it links itself to a directory on your computer, which R calls the working directory. This is where R will look for files when you attempt to load them, and it is where R will save files when you save them. The location of your working directory will vary on different computers. To determine which directory R is using as your working directory, run:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## "/Users/garrettgrolemund"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can place data files straight into the folder that is your working directory, or you can move your working directory to where your data files are. You can move your working directory to any folder on your computer with the function <code>setwd</code>. Just give <code>setwd</code> the file path to your new working directory. I prefer to set my working directory to a folder dedicated to whichever project I am currently working on. That way I can keep all of my data, scripts, graphs, and reports in the same place. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Users/garrettgrolemund/Documents/Book_Project"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the file path does not begin with your root directory, R will assume that it begins at your current working directory.</p>
<p>You can also change your working directory by clicking on Session &gt; Set Working Directory &gt; Choose Directory in the RStudio menu bar. The Windows and Mac GUIs have similar options. If you start R from a UNIX command line (as on Linux machines), the working directory will be whichever directory you were in when you called R.</p>
<p>You can see what files are in your working directory with <code>list.files()</code>. If you see the file that you would like to open in your working directory, then you are ready to proceed. How you open files in your working directory will depend on which type of file you would like to open.</p>
</section>
<section id="plain-text-files" class="level2" data-number="D.3">
<h2 data-number="D.3" class="anchored" data-anchor-id="plain-text-files"><span class="header-section-number">D.3</span> Plain-text Files</h2>
<p>Plain-text files are one of the most common ways to save data. They are very simple and can be read by many different computer programs—even the most basic text editors. For this reason, public data often comes as plain-text files. For example, the Census Bureau, the Social Security Administration, and the Bureau of Labor Statistics all make their data available as plain-text files.</p>
<p>Here’s how the royal flush data set from <a href="objects.html">Section&nbsp;<span>3</span></a> would appear as a plain-text file (I’ve added a value column):</p>
<pre><code>"card", "suit", "value"
"ace", "spades", 14
"king", "spades", 13
"queen", "spades", 12
"jack", "spades", 11
"ten", "spades", 10</code></pre>
<p>A plain-text file stores a table of data in a text document. Each row of the table is saved on its own line, and a simple convention is used to separate the cells within a row. Often cells are separated by a comma, but they can also be separated by a tab, a pipe delimiter (i.e., <code>|</code> ), or any other character. Each file only uses one method of separating cells, which minimizes confusion. Within each cell, data appears as you’d expect to see it, as words and numbers.</p>
<p>All plain-text files can be saved with the extension <em>.txt</em> (for text), but sometimes a file will receive a special extension that advertises how it separates data-cell entries. Since entries in the data set mentioned earlier are separated with a comma, this file would be a <em>comma-separated-values</em> file and would usually be saved with the extension <em>.csv</em>.</p>
<section id="read.table" class="level3" data-number="D.3.1">
<h3 data-number="D.3.1" class="anchored" data-anchor-id="read.table"><span class="header-section-number">D.3.1</span> read.table</h3>
<p>To load a plain-text file, use <code>read.table</code>. The first argument of <code>read.table</code> should be the name of your file (if it is in your working directory), or the file path to your file (if it is not in your working directory). If the file path does not begin with your root directory, R will append it to the end of the file path that leads to your working directory.You can give <code>read.table</code> other arguments as well. The two most important are <code>sep</code> and <code>header</code>.</p>
<p>If the royal flush data set was saved as a file named <em>poker.csv</em> in your working directory, you could load it with:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"poker.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="sep" class="level4" data-number="D.3.1.1">
<h4 data-number="D.3.1.1" class="anchored" data-anchor-id="sep"><span class="header-section-number">D.3.1.1</span> sep</h4>
<p>Use <code>sep</code> to tell <code>read.table</code> what character your file uses to separate data entries. To find this out, you might have to open your file in a text editor and look at it. If you don’t specify a <code>sep</code> argument, <code>read.table</code> will try to separate cells whenever it comes to white space, such as a tab or space. R won’t be able to tell you if <code>read.table</code> does this correctly or not, so rely on it at your own risk.</p>
</section>
<section id="header" class="level4" data-number="D.3.1.2">
<h4 data-number="D.3.1.2" class="anchored" data-anchor-id="header"><span class="header-section-number">D.3.1.2</span> header</h4>
<p>Use <code>header</code> to tell <code>read.table</code> whether the first line of the file contains variable names instead of values. If the first line of the file is a set of variable names, you should set <code>header = TRUE</code>.</p>
</section>
<section id="na.strings" class="level4" data-number="D.3.1.3">
<h4 data-number="D.3.1.3" class="anchored" data-anchor-id="na.strings"><span class="header-section-number">D.3.1.3</span> na.strings</h4>
<p>Oftentimes data sets will use special symbols to represent missing information. If you know that your data uses a certain symbol to represent missing entries, you can tell <code>read.table</code> (and the preceding functions) what the symbol is with the <code>na.strings</code> argument. <code>read.table</code> will convert all instances of the missing information symbol to <code>NA</code>, which is R’s missing information symbol (see <a href="modifying.html#sec-missing">Missing Information</a>).</p>
<p>For example, your poker data set contained missing values stored as a <code>.</code>, like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## "card","suit","value"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## "ace"," spades"," 14"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## "king"," spades"," 13"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## "queen",".","."</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## "jack",".","."</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## "ten",".","."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You could read the data set into R and convert the missing values into NAs as you go with the command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"poker.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">na.string =</span> <span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>R would save a version of <code>poker</code> that looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  card    suit value</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   ace  spades    14</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  king  spades    13</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## queen    &lt;NA&gt;    NA</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  jack    &lt;NA&gt;    NA</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   ten    &lt;NA&gt;    NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="skip-and-nrow" class="level4" data-number="D.3.1.4">
<h4 data-number="D.3.1.4" class="anchored" data-anchor-id="skip-and-nrow"><span class="header-section-number">D.3.1.4</span> skip and nrow</h4>
<p>Sometimes a plain-text file will come with introductory text that is not part of the data set. Or, you may decide that you only wish to read in part of a data set. You can do these things with the <code>skip</code> and <code>nrow</code> arguments. Use <code>skip</code> to tell R to skip a specific number of lines before it starts reading in values from the file. Use <code>nrow</code> to tell R to stop reading in values after it has read in a certain number of lines.</p>
<p>For example, imagine that the complete royal flush file looks like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>This data was collected by the National Poker Institute. </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>We accidentally repeated the last row of data.</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">"card"</span>, <span class="st">"suit"</span>, <span class="st">"value"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">"ace"</span>, <span class="st">"spades"</span>, <span class="dv">14</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">"king"</span>, <span class="st">"spades"</span>, <span class="dv">13</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">"queen"</span>, <span class="st">"spades"</span>, <span class="dv">12</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">"jack"</span>, <span class="st">"spades"</span>, <span class="dv">11</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">"ten"</span>, <span class="st">"spades"</span>, <span class="dv">10</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">"ten"</span>, <span class="st">"spades"</span>, <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can read just the six lines that you want (five rows plus a header) with:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"poker.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    card    suit value</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   ace  spades    14</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  king  spades    13</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 queen  spades    12</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  jack  spades    11</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5   ten  spades    10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice that the header row doesn’t count towards the total rows allowed by <code>nrow</code>.</p>
</section>
<section id="stringsasfactors" class="level4" data-number="D.3.1.5">
<h4 data-number="D.3.1.5" class="anchored" data-anchor-id="stringsasfactors"><span class="header-section-number">D.3.1.5</span> stringsAsFactors</h4>
<p>R reads in numbers just as you’d expect, but when R comes across character strings (e.g., letters and words) it begins to act strangely. R wants to convert every character string into a factor. This is R’s default behavior, but I think it is a mistake. Sometimes factors are useful. At other times, they’re clearly the wrong data type for the job. Also factors cause weird behavior, especially when you want to display data. This behavior can be surprising if you didn’t realize that R converted your data to factors. In general, you’ll have a smoother R experience if you don’t let R make factors until you ask for them. Thankfully, it is easy to do this.</p>
<p>Setting the argument <code>stringsAsFactors</code> to <code>FALSE</code> will ensure that R saves any character strings in your data set as character strings, not factors. To use <code>stringsAsFactors</code>, you’d write:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"poker.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you will be loading more than one data file, you can change the default factoring behavior at the global level with:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will ensure that all strings will be read as strings, not as factors, until you end your R session, or rechange the global default by running:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="the-read-family" class="level3" data-number="D.3.2">
<h3 data-number="D.3.2" class="anchored" data-anchor-id="the-read-family"><span class="header-section-number">D.3.2</span> The read Family</h3>
<p>R also comes with some prepackaged short cuts for <code>read.table</code>, shown in <a href="#tbl-shortcuts">Table&nbsp;<span>D.1</span></a>.</p>
<div id="tbl-shortcuts" class="anchored">
<table class="table">
<caption>Table D.1: R’s read functions. You can overwrite any of the default arguments as necessary.</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 36%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Defaults</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>read.table</code></td>
<td>sep = ” “, header = FALSE</td>
<td>General-purpose read function</td>
</tr>
<tr class="even">
<td><code>read.csv</code></td>
<td>sep = “,”, header = TRUE</td>
<td>Comma-separated-variable (CSV) files</td>
</tr>
<tr class="odd">
<td><code>read.delim</code></td>
<td>sep = “, header = TRUE</td>
<td>Tab-delimited files</td>
</tr>
<tr class="even">
<td><code>read.csv2</code></td>
<td>sep = “;”, header = TRUE, dec = “,”</td>
<td>CSV files with European decimal format</td>
</tr>
<tr class="odd">
<td><code>read.delim2</code></td>
<td>sep = “, header = TRUE, dec =”,”</td>
<td>Tab-delimited files with European decimal format</td>
</tr>
</tbody>
</table>
</div>
<p>The first shortcut, <code>read.csv</code>, behaves just like <code>read.table</code> but automatically sets <code>sep = ","</code> and <code>header = TRUE</code>, which can save you some typing:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"poker.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>read.delim</code> automatically sets <code>sep</code> to the tab character, which is very handy for reading tab delimited files. These are files where each cell is separated by a tab. <code>read.delim</code> also sets <code>header = TRUE</code> by default.</p>
<p><code>read.delim2</code> and <code>read.csv2</code> exist for European R users. These functions tell R that the data uses a comma instead of a period to denote decimal places. (If you’re wondering how this works with CSV files, CSV2 files usually separate cells with a semicolon, not a comma.)</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Import Dataset
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also load plain text files with RStudio’s Import Dataset button, as described in <a href="#loading">Loading Data</a>. Import Dataset provides a GUI version of <code>read.table</code>.</p>
</div>
</div>
</section>
<section id="read.fwf" class="level3" data-number="D.3.3">
<h3 data-number="D.3.3" class="anchored" data-anchor-id="read.fwf"><span class="header-section-number">D.3.3</span> read.fwf</h3>
<p>One type of plain-text file defies the pattern by using its layout to separate data cells. Each row is placed in its own line (as with other plain-text files), and then each column begins at a specific number of characters from the lefthand side of the document. To achieve this, an arbitrary number of character spaces is added to the end of each entry to correctly position the next entry. These documents are known as <em>fixed-width files</em> and usually end with the extension <em>.fwf</em>.</p>
<p>Here’s one way the royal flush data set could look as a fixed-width file. In each row, the suit entry begins exactly 10 characters from the start of the line. It doesn’t matter how many characters appeared in the first cell of each row:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>card      suit       value</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ace       spades     14</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>king      spades     13  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>queen     spades     12  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>jack      spades     11  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>10        spades     10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Fixed-width files look nice to human eyes (but no better than a tab-delimited file); however, they can be difficult to work with. Perhaps because of this, R comes with a function for reading fixed-width files, but no function for saving them. Unfortunately, US government agencies seem to like fixed-width files, and you’ll likely encounter one or more during your career.</p>
<p>You can read fixed-width files into R with the function <code>read.fwf</code>. The function takes the same arguments as <code>read.table</code> but requires an additional argument, <code>widths</code>, which should be a vector of numbers. Each _i_th entry of the <code>widths</code> vector should state the width (in characters) of the _i_th column of the data set.</p>
<p>If the aforementioned fixed-width royal flush data was saved as <em>poker.fwf</em> in your working directory, you could read it with:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">read.fwf</span>(<span class="st">"poker.fwf"</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">6</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="html-links" class="level3" data-number="D.3.4">
<h3 data-number="D.3.4" class="anchored" data-anchor-id="html-links"><span class="header-section-number">D.3.4</span> HTML Links</h3>
<p>Many data files are made available on the Internet at their own web address. If you are connected to the Internet, you can open these files straight into R with <code>read.table</code>, <code>read.csv</code>, etc. You can pass a web address into the file name argument for any of R’s data-reading functions. As a result, you could read in the poker data set from a web address like <a href="http://" class="uri"><em>http://</em></a><em>…/poker.csv</em> with:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"http://.../poker.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That’s obviously not a real address, but here’s something that would work—if you can manage to type it!</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>deck <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://gist.githubusercontent.com/garrettgman/9629323/raw/ee5dfc039fd581cb467cc69c226ea2524913c3d8/deck.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Just make sure that the web address links directly to the file and not to a web page that links to the file. Usually, when you visit a data file’s web address, the file will begin to download or the raw data will appear in your browser window.</p>
<p>Note that websites that begin with _<a href="https://_" class="uri">https://_</a> are secure websites, which means R may not be able to access the data provided at these links.</p>
</section>
<section id="saving-plain-text-files" class="level3" data-number="D.3.5">
<h3 data-number="D.3.5" class="anchored" data-anchor-id="saving-plain-text-files"><span class="header-section-number">D.3.5</span> Saving Plain-Text Files</h3>
<p>Once your data is in R, you can save it to any file format that R supports. If you’d like to save it as a plain-text file, you can use the +write+ family of functions. The three basic write functions appear in <a href="#tbl-write">Table&nbsp;<span>D.2</span></a>. Use <code>write.csv</code> to save your data as a <em>.csv</em> file and <code>write.table</code> to save your data as a tab delimited document or a document with more exotic separators.</p>
<div id="tbl-write" class="anchored">
<table class="table">
<caption>Table D.2: R saves data sets to plain-text files with the write family of functions</caption>
<colgroup>
<col style="width: 37%">
<col style="width: 62%">
</colgroup>
<thead>
<tr class="header">
<th>File format</th>
<th>Function and syntax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>.csv</strong></td>
<td><code>write.csv(r_object, file = filepath, row.names = FALSE)</code></td>
</tr>
<tr class="even">
<td><strong>.csv</strong> (with European decimal notation)</td>
<td><code>write.csv2(r_object, file = filepath, row.names = FALSE)</code></td>
</tr>
<tr class="odd">
<td>tab delimited</td>
<td><code>write.table(r_object, file = filepath, sep = "\t", row.names=FALSE)</code></td>
</tr>
</tbody>
</table>
</div>
<p>The first argument of each function is the R object that contains your data set. The <code>file</code> argument is the file name (including extension) that you wish to give the saved data. By default, each function will save your data into your working directory. However, you can supply a file path to the file argument. R will oblige by saving the file at the end of the file path. If the file path does not begin with your root directory, R will append it to the end of the file path that leads to your working directory.</p>
<p>For example, you can save the (hypothetical) poker data frame to a subdirectory named <em>data</em> within your working directory with the command:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(poker, <span class="st">"data/poker.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Keep in mind that <code>write.csv</code> and <code>write.table</code> cannot create new directories on your computer. Each folder in the file path must exist before you try to save a file with it.</p>
<p>The <code>row.names</code> argument prevents R from saving the data frame’s row names as a column in the plain-text file. You might have noticed that R automatically names each row in a data frame with a number. For example, each row in our poker data frame appears with a number next to it:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>poker</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    card   suit value</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   ace spades    14</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  king spades    13</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 queen spades    12</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  jack spades    11</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    10 spades    10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These row numbers are helpful, but can quickly accumulate if you start saving them. R will add a new set of numbers by default each time you read the file back in. Avoid this by always setting <code>row.names = FALSE</code> when you use a function in the <code>write</code> family.</p>
</section>
<section id="compressing-files" class="level3" data-number="D.3.6">
<h3 data-number="D.3.6" class="anchored" data-anchor-id="compressing-files"><span class="header-section-number">D.3.6</span> Compressing Files</h3>
<p>To compress a plain-text file, surround the file name or file path with the function <code>bzfile</code>, <code>gzfile</code>, or <code>xzfile</code>. For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(poker, <span class="at">file =</span> <span class="fu">bzfile</span>(<span class="st">"data/poker.csv.bz2"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Each of these functions will compress the output with a different type of compression format, shown in <a href="#tbl-compression">Table&nbsp;<span>D.3</span></a>.</p>
<div id="tbl-compression" class="anchored">
<table class="table">
<caption>Table D.3: R comes with three helper functions for compressing files</caption>
<thead>
<tr class="header">
<th>Function</th>
<th>Compression type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>bzfile</code></td>
<td>bzip2</td>
</tr>
<tr class="even">
<td><code>gzfile</code></td>
<td>gnu zip (gzip)</td>
</tr>
<tr class="odd">
<td><code>xzfile</code></td>
<td>xz compression</td>
</tr>
</tbody>
</table>
</div>
<p>It is a good idea to adjust your file’s extension to reflect the compression. R’s <code>read</code> functions will open plain-text files compressed in any of these formats. For example, you could read a compressed file named <em>poker.csv.bz2</em> with:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"poker.csv.bz2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"data/poker.csv.bz2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>depending on where the file is saved.</p>
</section>
</section>
<section id="r-files" class="level2" data-number="D.4">
<h2 data-number="D.4" class="anchored" data-anchor-id="r-files"><span class="header-section-number">D.4</span> R Files</h2>
<p>R provides two file formats of its own for storing data, <em>.RDS</em> and <em>.RData</em>. RDS files can store a single R object, and RData files can store multiple R objects.</p>
<p>You can open a RDS file with <code>readRDS</code>. For example, if the royal flush data was saved as <em>poker.RDS</em>, you could open it with:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>poker <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"poker.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Opening RData files is even easier. Simply run the function <code>load</code> with the file:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"file.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There’s no need to assign the output to an object. The R objects in your RData file will be loaded into your R session with their original names. RData files can contain multiple R objects, so loading one may read in multiple objects. <code>load</code> doesn’t tell you how many objects it is reading in, nor what their names are, so it pays to know a little about the RData file before you load it.</p>
<p>If worse comes to worst, you can keep an eye on the environment pane in RStudio as you load an RData file. It displays all of the objects that you have created or loaded during your R session. Another useful trick is to put parentheses around your load command like so, <code>(load("poker.RData"))</code>. This will cause R to print out the names of each object it loads from the file.</p>
<p>Both <code>readRDS</code> and <code>load</code> take a file path as their first argument, just like R’s other read and write functions. If your file is in your working directory, the file path will be the file name.</p>
<section id="saving-r-files" class="level3" data-number="D.4.1">
<h3 data-number="D.4.1" class="anchored" data-anchor-id="saving-r-files"><span class="header-section-number">D.4.1</span> Saving R Files</h3>
<p>You can save an R object like a data frame as either an RData file or an RDS file. RData files can store multiple R objects at once, but RDS files are the better choice because they foster reproducible code.</p>
<p>To save data as an RData object, use the <code>save</code> function. To save data as a RDS object, use the <code>saveRDS</code> function. In each case, the first argument should be the name of the R object you wish to save. You should then include a file argument that has the file name or file path you want to save the data set to.</p>
<p>For example, if you have three R objects, <code>a</code>, <code>b</code>, and <code>c</code>, you could save them all in the same RData file and then reload them in another R session:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(a, b, c, <span class="at">file =</span> <span class="st">"stuff.RData"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"stuff.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, if you forget the names of your objects or give your file to someone else to use, it will be difficult to determine what was in the file—even after you (or they) load it. The user interface for RDS files is much more clear. You can save only one object per file, and whoever loads it can decide what they want to call their new data. As a bonus, you don’t have to worry about <code>load</code> overwriting any R objects that happened to have the same name as the objects you are loading:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(a, <span class="at">file =</span> <span class="st">"stuff.RDS"</span>) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"stuff.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Saving your data as an R file offers some advantages over saving your data as a plain-text file. R automatically compresses the file and will also save any R-related metadata associated with your object. This can be handy if your data contains factors, dates and times, or class attributes. You won’t have to reparse this information into R the way you would if you converted everything to a text file.</p>
<p>On the other hand, R files cannot be read by many other programs, which makes them inefficient for sharing. They may also create a problem for long-term storage if you don’t think you’ll have a copy of R when you reopen the files.</p>
</section>
</section>
<section id="excel-spreadsheets" class="level2" data-number="D.5">
<h2 data-number="D.5" class="anchored" data-anchor-id="excel-spreadsheets"><span class="header-section-number">D.5</span> Excel Spreadsheets</h2>
<p>Microsoft Excel is a popular spreadsheet program that has become almost industry standard in the business world. There is a good chance that you will need to work with an Excel spreadsheet in R at least once in your career. You can read spreadsheets into R and also save R data as a spreadsheet in a variety of ways.</p>
<section id="export-from-excel" class="level3" data-number="D.5.1">
<h3 data-number="D.5.1" class="anchored" data-anchor-id="export-from-excel"><span class="header-section-number">D.5.1</span> Export from Excel</h3>
<p>The best method for moving data from Excel to R is to export the spreadsheet from Excel as a <em>.csv</em> or <em>.txt</em> file. Not only will R be able to read the text file, so will any other data analysis software. Text files are the lingua franca of data storage.</p>
<p>Exporting the data solves another difficulty as well. Excel uses proprietary formats and metadata that will not easily transfer into R. For example, a single Excel file can include multiple spreadsheets, each with their own columns and macros. When Excel exports the file as a <em>.csv</em> or <em>.txt</em>, it makes sure this format is transferred into a plain-text file in the most appropriate way. R may not be able to manage the conversion as efficiently.</p>
<p>To export data from Excel, open the Excel spreadsheet and then go to Save As in the Microsoft Office Button menu. Then choose CSV in the Save as type box that appears and save the files. You can then read the file into R with the <code>read.csv</code> function.</p>
</section>
<section id="copy-and-paste" class="level3" data-number="D.5.2">
<h3 data-number="D.5.2" class="anchored" data-anchor-id="copy-and-paste"><span class="header-section-number">D.5.2</span> Copy and Paste</h3>
<p>You can also copy portions of an Excel spreadsheet and paste them into R. To do this, open the spreadsheet and select the cells you wish to read into R. Then select Edit &gt; Copy in the menu bar—or use a keyboard shortcut—to copy the cells to your clipboard.</p>
<p>On most operating systems, you can read the data stored in your clipboard into R with:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"clipboard"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On Macs you will need to use:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="fu">pipe</span>(<span class="st">"pbpaste"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the cells contain values with spaces in them, this will disrupt <code>read.table</code>. You can try another <code>read</code> function (or just formally export the data from Excel) before reading it into R.</p>
</section>
<section id="xlconnect" class="level3" data-number="D.5.3">
<h3 data-number="D.5.3" class="anchored" data-anchor-id="xlconnect"><span class="header-section-number">D.5.3</span> XLConnect</h3>
<p>Many packages have been written to help you read Excel files directly into R. Unfortunately, many of these packages do not work on all operating systems. Others have been made out of date by the <em>.xlsx</em> file format. One package that does work on all file systems (and gets good reviews) is the XLConnect package. To use it, you’ll need to install and load the package:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"XLConnect"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XLConnect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>XLConnect relies on Java to be platform independent. So when you first open XLConnect, RStudio may ask to download a Java Runtime Environment if you do not already have one.</p>
</section>
<section id="reading-spreadsheets" class="level3" data-number="D.5.4">
<h3 data-number="D.5.4" class="anchored" data-anchor-id="reading-spreadsheets"><span class="header-section-number">D.5.4</span> Reading Spreadsheets</h3>
<p>You can use XLConnect to read in an Excel spreadsheet with either a one- or a two-step process. I’ll start with the two-step process. First, load an Excel workbook with <code>loadWorkbook</code>. <code>loadWorkbook</code> can load both <em>.xls</em> and <em>.xlsx</em> files. It takes one argument: the file path to your Excel workbook (this will be the name of the workbook if it is saved in your working directory):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">loadWorkbook</span>(<span class="st">"file.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Next, read a spreadsheet from the workbook with <code>readWorksheet</code>, which takes several arguments. The first argument should be a workbook object created with <code>loadWorkbook</code>. The next argument, <code>sheet</code>, should be the name of the spreadsheet in the workbook that you would like to read into R. This will be the name that appears on the bottom tab of the spreadsheet. You can also give <code>sheet</code> a number, which specifies the sheet that you want to read in (one for the first sheet, two for the second, and so on).</p>
<p><code>readWorksheet</code> then takes four arguments that specify a bounding box of cells to read in: <code>startRow</code>, <code>startCol</code>, <code>endRow</code>, and <code>endCol</code>. Use <code>startRow</code> and <code>startCol</code> to describe the cell in the top-left corner of the bounding box of cells that you wish to read in. Use <code>endRow</code> and <code>endCol</code> to specify the cell in the bottom-right corner of the bounding box. Each of these arguments takes a number. If you do not supply bounding arguments, <code>readWorksheet</code> will read in the rectangular region of cells in the spreadsheet that appears to contain data. <code>readWorksheet</code> will assume that this region contains a header row, but you can tell it otherwise with <code>header = FALSE</code>.</p>
<p>So to read in the first worksheet from <code>wb</code>, you could use:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sheet1 <span class="ot">&lt;-</span> <span class="fu">readWorksheet</span>(wb, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">0</span>, <span class="at">startCol =</span> <span class="dv">0</span>, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">endRow =</span> <span class="dv">100</span>, <span class="at">endCol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>R will save the output as a data frame. All of the arguments in <code>readWorkbook</code> except the first are vectorized, so you can use it to read in multiple sheets from the same workbook at once (or multiple cell regions from a single worksheet). In this case, <code>readWorksheet</code> will return a list of data frames.</p>
<p>You can combine these two steps with <code>readWorksheetFromFile</code>. It takes the file argument from <code>loadWorkbook</code> and combines it with the arguments from <code>readWorksheet</code>. You can use it to read one or more sheets straight from an Excel file:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sheet1 <span class="ot">&lt;-</span> <span class="fu">readWorksheetFromFile</span>(<span class="st">"file.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">0</span>, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">startCol =</span> <span class="dv">0</span>, <span class="at">endRow =</span> <span class="dv">100</span>, <span class="at">endCol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="writing-spreadsheets" class="level3" data-number="D.5.5">
<h3 data-number="D.5.5" class="anchored" data-anchor-id="writing-spreadsheets"><span class="header-section-number">D.5.5</span> Writing Spreadsheets</h3>
<p>Writing to an Excel spreadsheet is a four-step process. First, you need to set up a workbook object with <code>loadWorkbook</code>. This works just as before, except if you are not using an existing Excel file, you should add the argument <code>create = TRUE</code>. XLConnect will create a blank workbook. When you save it, XLConnect will write it to the file location that you specified here with <code>loadWorkbook</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">loadWorkbook</span>(<span class="st">"file.xlsx"</span>, <span class="at">create =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Next, you need to create a worksheet inside your workbook object with <code>createSheet</code>. Tell <code>createSheet</code> which workbook to place the sheet in and which to use for the sheet.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">createSheet</span>(wb, <span class="st">"Sheet 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then you can save your data frame or matrix to the sheet with <code>writeWorksheet</code>. The first argument of <code>writeWorksheet</code>, <code>object</code>, is the workbook to write the data to. The second argument, <code>data</code>, is the data to write. The third argument, <code>sheet</code>, is the name of the sheet to write it to. The next two arguments, <code>startRow</code> and <code>startCol</code>, tell R where in the spreadsheet to place the upper-left cell of the new data. These arguments each default to 1. Finally, you can use <code>header</code> to tell R whether your column names should be written with the data:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeWorksheet</span>(wb, <span class="at">data =</span> poker, <span class="at">sheet =</span> <span class="st">"Sheet 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once you have finished adding sheets and data to your workbook, you can save it by running <code>saveWorkbook</code> on the workbook object. R will save the workbook to the file name or path you provided in <code>loadWorkbook</code>. If this leads to an existing Excel file, R will overwrite it. If it leads to a new file, R will create it.</p>
<p>You can also collapse these steps into a single call with <code>writeWorksheetToFile</code>, like this:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeWorksheetToFile</span>(<span class="st">"file.xlsx"</span>, <span class="at">data =</span> poker, <span class="at">sheet =</span> <span class="st">"Sheet 1"</span>, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">startRow =</span> <span class="dv">1</span>, <span class="at">startCol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The XLConnect package also lets you do more advanced things with Excel spreadsheets, such as writing to a named region in a spreadsheet, working with formulas, and assigning styles to cells. You can read about these features in XLConnect’s vignette, which is accessible by loading XLConnect and then running:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"XLConnect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="loading-files-from-other-programs" class="level2" data-number="D.6">
<h2 data-number="D.6" class="anchored" data-anchor-id="loading-files-from-other-programs"><span class="header-section-number">D.6</span> Loading Files from Other Programs</h2>
<p>You should follow the same advice I gave you for Excel files whenever you wish to work with file formats native to other programs: open the file in the original program and export the data as a plain-text file, usually a CSV. This will ensure the most faithful transcription of the data in the file, and it will usually give you the most options for customizing how the data is transcribed.</p>
<p>Sometimes, however, you may acquire a file but not the program it came from. As a result, you won’t be able to open the file in its native program and export it as a text file. In this case, you can use one of the functions in <a href="#tbl-others">Table&nbsp;<span>D.4</span></a> to open the file. These functions mostly come in R’s <code>foreign</code> package. Each attempts to read in a different file format with as few hiccups as possible.</p>
<div id="tbl-others" class="anchored">
<table class="table">
<caption>Table D.4: A number of functions will attempt to read the file types of other data-analysis programs</caption>
<thead>
<tr class="header">
<th>File format</th>
<th>Function</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ERSI ArcGIS</td>
<td><code>read.shapefile</code></td>
<td>shapefiles</td>
</tr>
<tr class="even">
<td>Matlab</td>
<td><code>readMat</code></td>
<td>R.matlab</td>
</tr>
<tr class="odd">
<td>minitab</td>
<td><code>read.mtp</code></td>
<td>foreign</td>
</tr>
<tr class="even">
<td>SAS (permanent data set)</td>
<td><code>read.ssd</code></td>
<td>foreign</td>
</tr>
<tr class="odd">
<td>SAS (XPORT format)</td>
<td><code>read.xport</code></td>
<td>foreign</td>
</tr>
<tr class="even">
<td>SPSS</td>
<td><code>read.spss</code></td>
<td>foreign</td>
</tr>
<tr class="odd">
<td>Stata</td>
<td><code>read.dta</code></td>
<td>foreign</td>
</tr>
<tr class="even">
<td>Systat</td>
<td><code>read.systat</code></td>
<td>foreign</td>
</tr>
</tbody>
</table>
</div>
<section id="connecting-to-databases" class="level3" data-number="D.6.1">
<h3 data-number="D.6.1" class="anchored" data-anchor-id="connecting-to-databases"><span class="header-section-number">D.6.1</span> Connecting to Databases</h3>
<p>You can also use R to connect to a database and read in data.</p>
<p>Use the RODBC package to connect to databases through an ODBC connection.</p>
<p>Use the DBI package to connect to databases through individual drivers. The DBI package provides a common syntax for working with different databases. You will have to download a database-specific package to use in conjunction with DBI. These packages provide the API for the native drivers of different database programs. For MySQL use RMySQL, for SQLite use RSQLite, for Oracle use ROracle, for PostgreSQL use RPostgreSQL, and for databases that use drivers based on the Java Database Connectivity (JDBC) API use RJDBC. Once you have loaded the appropriate driver package, you can use the commands provided by DBI to access your database.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./a3-updating.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Updating R and Its Packages</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./a5-debug.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Debugging R Code</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>